# Interaktive Visualisierungen

## Einleitende Bemerkungen

Bei den drei vorgestellten Paketen handelt es sich um sehr flexible Frameworks, deren ausführliche Besprechung (so wie ggplot2) problemlos ein eigenes Seminar füllen könnten.
Hier werden sie nur anhand von einfachsten Beispielen schnell vorgestellt.
Bei der weiterführenden Anwendung im Rahmen eines Projekts ist es sinnvoll, sich noch einmal zielgerichtet zu beraten.

## Interaktive Karten mit `tmap`

### Vorbereitung

Wir laden `tmap` und importieren einen Beispieldatensatz (simple features) mit medizinische Statistiken aus North Carolina:

```{r, cache = F}
library(tmap)
library(sf)
demo(nc, ask = F, echo = F)
```
### Bisher: Karten mit `ggpot2`

Wir haben schon gelernt, wie man mit dem Befehl `ggplot()` Karten erstellt.
Zur Wiederholung zeichnen wir eine Choropletenkarte mit den Geburtsraten der Counties von 1974:

```{r}
library(ggplot2)

ggplot(nc) +
  geom_sf(aes(fill = BIR74))
```

### Neu: Karten mit `tmap`

Der Befehl `qtm()` ("quick thematic map") ist ideal um Geodaten schnell zu visualisieren:

```{r}
qtm(nc, fill = "BIR74")
```

Für ausführlichere Karten folgt `tmap` einer sehr ähnlichen Logik wie `ggplot2`, hat aber einige Unterschiede in der "Grammatik":

```{r}
tm_shape(nc) +
  tm_polygons(col = c("BIR74", "BIR79"), title = "Geburten") +
  tm_facets() +
  tm_layout(panel.show = T,
            panel.labels = c("1974", "1979"),
            legend.outside = T, legend.position = c("center", "center"))
```

### Interaktive Karten

Wenn wir den `tmap_mode` einmal wechseln,

```{r cache = F}
tmap_mode("view")
```

zeichnen wir ab sofort interaktive Karten:

```{r, cache = F, eval = is_html}
qtm(nc)
```

Hier lassen sich dann auch interaktive Elemente wie Popups, Layer und die Hintergrundkarte bearbeiten. (Hier nur als technische Demonstration, besonders hilfreich finde ich es nicht:)

```{r, cache = F, eval = is_html}
tm_shape(nc, cache = F) +
  tm_basemap("OpenStreetMap") +
  tm_polygons(col = c("BIR74", "BIR79"), id = "NAME", popup.vars = c("AREA", "CNTY_ID")) +
  tm_facets(as.layers = T)
```

### Weitere Informationen:

- [tmap: get started!](https://cran.r-project.org/web/packages/tmap/vignettes/tmap-getstarted.html)
- [Making maps with R: tmap](https://bookdown.org/nicohahn/making_maps_with_r5/docs/tmap.html)

## Interaktive Plots mit `plotly`

Plotly ist ein kommerzielles Produkt, das Framework lässt sich aber offen nutzen. (Verkauft werden sollen dann Dashboards, Beratungsleistungen und Infrastruktur für Firmenkunden.)

### Bisher: Scatterplot mit `ggplot2`

Wir plotten den Beispieldatensatz `iris`:

```{r}
ggplot(iris) +
  geom_point(aes(x = Sepal.Length, y = Sepal.Width, color = Petal.Length))
```

### Neu: 3D mit `plotly`

```{r, eval = is_html, cache = F}
library(plotly)

plot_ly(iris, x = ~ Sepal.Length, y = ~ Sepal.Width, z = ~ Petal.Width, color = ~ Petal.Length)
```

### Weitere Informationen

- [Plotly R Open Source Graphing Library](https://plotly.com/r/)
- [Getting Started with Plotly in R](https://plotly.com/r/getting-started/)

## Web apps mit `shiny`

Shiny ist das umfangreichste und flexibelste der hier vorgestellten Pakete und für das Erstellen von Web-Apps zur interaktiven Visualisierung von Datensätzen gedacht.

Visualisierungen mit Shniny können jedoch nicht als Teil einer statischen HTML-Seite angezeigt werden, sondern müssen zur Ansicht auf einem entsprechend konfigurierten Server laufen.

Wir haben in der Sitzung eine einfache Shiny-App erstellt und lokal angesehen, zur Veröffentlichung müsste sie jedoch z. B. auf https://shinyapps.io hochgeladen werden.

### Weitere Informationen

- [Learn Shiny](https://shiny.rstudio.com/tutorial/)
- [Mastering Shiny](https://mastering-shiny.org/)
